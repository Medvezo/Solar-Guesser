import { Tooltip } from "@nextui-org/react";

interface StreakDay {
  date: string;
  completed: boolean;
  isFireStreak: boolean;
}

interface StreakDisplayProps {
  streakDays: StreakDay[];
}

const StreakDisplay = ({ streakDays = [] }: StreakDisplayProps) => {
  // Generate last 7 days including today
  const generateLastSevenDays = () => {
    const days = [];
    for (let i = 6; i >= 0; i--) {
      const date = new Date();
      date.setDate(date.getDate() - i);
      days.push({
        date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
        completed: false,
        isFireStreak: false,
      });
    }
    return days;
  };

  // Merge default days with streak days based on date
  const mergedDays = generateLastSevenDays().map(defaultDay => {
    const matchingStreakDay = streakDays.find(
      streakDay => new Date(streakDay.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) === defaultDay.date
    );
    return matchingStreakDay || defaultDay;
  });

  return (
    <div className="flex items-center gap-2 bg-[#3C79D526] rounded-xl p-4">
      <div className="relative">
        <img
          src="/images/calendar.png"
          alt="Calendar"
          className="w-20 h-20 object-contain"
        />
        <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center flex flex-col justify-center items-center mt-1 -rotate-[15deg] text-sm">
          <span className="text-black font-bold text-sm">
            {streakDays.filter(day => day.isFireStreak).length}
          </span>
          <span className="text-black text-sm block">days</span>
        </div>
      </div>
      <div className="flex gap-2">
        {mergedDays.map((day, index) => (
          <Tooltip
            key={index}
            content={
              <div className="px-2 py-1">
                <p className="text-sm text-gray-300">
                  {day.date}
                </p>
              </div>
            }
            placement="top"
          >
            <div
              className={`relative w-10 h-10 rounded-lg border-2 flex items-center justify-center transition-all duration-300 ${
                day.isFireStreak
                    ? "border-orange-500 bg-[#FE6816A3]"
                    : day.date === new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' })
                      ? "border-sky-500 bg-transparent"
                      : "border-gray-600 bg-transparent"
              }`}
            >
              {day.isFireStreak && (
                <svg width="26" height="38" className="absolute -top-3 " viewBox="0 0 17 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5576 3.49207C10.7515 3.68802 10.9275 3.90461 11.0855 4.14174C11.3593 4.58109 11.5894 5.04131 11.7758 5.52231C11.6878 5.51915 11.6066 5.49202 11.5321 5.4411C11.5187 5.64104 11.3834 5.74929 11.1261 5.76594C10.6172 5.67661 10.4141 5.3789 10.517 4.87263C10.7917 4.6532 10.7781 4.46374 10.4764 4.30416C10.401 4.20761 10.3739 4.09935 10.3952 3.97932C10.4764 3.97932 10.5576 3.97932 10.6388 3.97932C10.6405 3.8459 10.5863 3.73764 10.4764 3.65449C10.5059 3.59902 10.5329 3.54485 10.5576 3.49207Z" fill="#FE6816"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5575 3.49202C10.5328 3.54481 10.5058 3.59898 10.4763 3.65444C10.5862 3.7376 10.6404 3.84586 10.6387 3.97928C10.5575 3.97928 10.4763 3.97928 10.3951 3.97928C10.3738 4.09931 10.4009 4.20757 10.4763 4.30412C10.778 4.4637 10.7916 4.65316 10.5169 4.87259C10.414 5.37886 10.617 5.67657 11.126 5.7659C11.3833 5.74925 11.5186 5.641 11.532 5.44106C11.6065 5.49198 11.6877 5.5191 11.7757 5.52227C12.2993 6.59343 12.6377 7.73037 12.7908 8.93309C12.8044 9.58447 12.845 10.2342 12.9126 10.8821C13.7891 10.213 14.2899 9.31973 14.415 8.2022C15.9417 10.5898 16.7673 13.202 16.8919 16.039C16.875 19.3495 15.4673 21.867 12.669 23.5915C12.2019 23.8507 11.7146 24.0537 11.2072 24.2005C12.8254 22.9909 13.5427 21.3667 13.3593 19.328C13.2292 18.5861 12.9856 17.8823 12.6284 17.2165C12.0101 16.3004 11.3604 15.4071 10.6793 14.5366C9.91133 13.3518 9.49172 12.0524 9.42058 10.6385C7.41104 12.3602 6.43652 14.5529 6.49703 17.2165C6.50791 17.6958 6.56199 18.1696 6.65944 18.6377C6.6324 18.6783 6.60528 18.7189 6.57823 18.7595C5.33629 18.0081 4.78139 16.8983 4.91343 15.4299C3.82587 17.0494 3.36565 18.836 3.53286 20.7897C3.68091 21.8438 4.12756 22.7371 4.87283 23.4697C4.86219 23.5297 4.87575 23.5838 4.91343 23.6321C5.15893 23.8106 5.389 24 5.60372 24.2005C1.98127 22.7382 0.113442 20.0448 0.000235122 16.1202C-0.0121088 14.3175 0.461588 12.6527 1.42141 11.1258C2.35638 9.79732 3.3309 8.49796 4.34496 7.22768C5.84735 5.06141 6.5918 2.65223 6.57823 0C8.18294 0.846775 9.50942 2.01076 10.5575 3.49202Z" fill="#FE6816"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M11.2073 24.2005C9.84473 24.7518 8.43712 24.8872 6.98435 24.6065C6.86636 24.4989 6.89348 24.4313 7.06556 24.4035C6.98833 24.3452 6.97485 24.2775 7.02496 24.2005C7.51392 23.9211 7.63574 23.5285 7.3904 23.0229C7.62819 23.06 7.87181 23.06 8.12129 23.0229C8.21249 22.9382 8.32074 22.8841 8.44613 22.8605C8.83578 22.592 8.86282 22.2942 8.52734 21.9672C8.69528 21.9114 8.8577 21.925 9.0146 22.0078C9.16118 21.9289 9.29656 21.8341 9.42065 21.7236C9.15867 21.6262 8.88799 21.5856 8.60855 21.6018C8.63454 21.3258 8.60749 21.0551 8.52734 20.7897C8.3672 20.855 8.24538 20.9634 8.1619 21.1145C7.49208 20.865 7.2214 21.0816 7.3498 21.7642C7.22352 22.2056 6.93928 22.4627 6.49709 22.5357C6.52414 22.5627 6.55126 22.5898 6.5783 22.6169C6.34369 22.8789 6.0865 23.1091 5.80681 23.3072C5.67647 23.2584 5.56822 23.1772 5.48197 23.0635C5.44372 23.3623 5.29478 23.4706 5.03532 23.3884C5.10231 23.3164 5.18352 23.2894 5.27895 23.3072C5.29673 23.2117 5.26969 23.1305 5.19774 23.0635C5.01875 23.1425 4.9105 23.2779 4.8729 23.4696C4.12763 22.7371 3.68098 21.8438 3.53293 20.7897C3.36572 18.8359 3.82594 17.0493 4.9135 15.4298C4.78145 16.8982 5.33636 18.0081 6.5783 18.7594C6.60535 18.7188 6.63247 18.6782 6.65951 18.6376C6.56206 18.1695 6.50798 17.6957 6.49709 17.2164C6.43659 14.5528 7.41111 12.3602 9.42065 10.6384C9.49179 12.0524 9.9114 13.3517 10.6794 14.5365C11.3605 15.4071 12.0102 16.3004 12.6284 17.2164C12.9857 17.8822 13.2293 18.586 13.3593 19.3279C13.5428 21.3667 12.8255 22.9909 11.2073 24.2005Z" fill="#FEB91E"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M6.98411 24.6065C6.50789 24.5199 6.04767 24.3846 5.60354 24.2005C5.38882 24 5.15875 23.8105 4.91325 23.632C4.87557 23.5838 4.86201 23.5296 4.87265 23.4696C4.91025 23.2779 5.0185 23.1425 5.19749 23.0635C5.26944 23.1305 5.29648 23.2118 5.2787 23.3072C5.18328 23.2894 5.10207 23.3164 5.03507 23.3884C5.29453 23.4706 5.44347 23.3623 5.48172 23.0635C5.56797 23.1772 5.67622 23.2584 5.80656 23.3072C6.08625 23.1091 6.34344 22.879 6.57806 22.6169C6.55101 22.5899 6.52389 22.5627 6.49685 22.5357C6.93903 22.4628 7.22327 22.2056 7.34955 21.7642C7.22116 21.0816 7.49183 20.865 8.16165 21.1145C8.24513 20.9634 8.36695 20.855 8.52709 20.7897C8.60725 21.0551 8.63429 21.3258 8.6083 21.6018C8.88775 21.5856 9.15842 21.6262 9.4204 21.7236C9.29631 21.8341 9.16094 21.9289 9.01435 22.0078C8.85746 21.925 8.69504 21.9114 8.52709 21.9672C8.86257 22.2942 8.83553 22.592 8.44588 22.8605C8.3205 22.8841 8.21224 22.9382 8.12104 23.0229C7.87157 23.06 7.62794 23.06 7.39016 23.0229C7.63549 23.5286 7.51368 23.9211 7.02471 24.2005C6.9746 24.2776 6.98809 24.3452 7.06532 24.4035C6.89323 24.4313 6.86611 24.4989 6.98411 24.6065Z" fill="#FBB925"/>
                </svg>
                
              )}
              
            </div>
          </Tooltip>
        ))}
      </div>
    </div>
  );
};

export default StreakDisplay; 